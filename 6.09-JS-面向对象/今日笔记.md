# 今日笔记

## this关键字

### 概述

#### this是什么

this关键字是JavaScript中最复杂的机制之一。它是一个很特别的关键字，被自动定义在所有函数的作用域中。但是即使是非常有经验的JavaScript开发者也很难说清它到底指向什么。

实际上，JavaScript中this的机制并没有那么先进，但是开发者往往会把理解过程复杂化。毫不夸张地说，不理解它的含义，大部分开发任务都无法完成。

this都有一个共同点， 它总是返回一个对象。简单说，this就是属性或方法“当前”所在的对象。



#### 为什么使用this

this提供了一种更优雅的方式来隐式“传递”一个对象引用，因此可以将API设计得更加简洁并且易于复用。

随着你的使用模式越来越复杂，显式传递上下文对象会让代码变得越来越混乱，使用this则不会这样。





#### 调用位置

想要了解this的绑定过程，首先要理解调用位置:调用位置就是函数在代码中被调用的位置(而不是声明的位置)。

通常来说，寻找调用位置就是寻找“函数被调用的位置”。最重要的是要分析调用栈(就是为了到达当前执行位置所调用的所有函数)。



#### this基本用法



```js
// this经常 被定义在函数的作用域中
function fn(){
    // this总是 要返回一个对象
    console.log(this.v)// this 指向哪个对象，不取决于函数定义的位置
}

// this指向哪个对象，取决于调用的位置
//函数的调用
fn()//undefined

//定义一个对象， 将fn函数作为obj对象的方法
varobj={
    v:200,
    f:fn
}
    
obj.f();//200

console.log(this.v)
```





### 绑定规则

#### 默认绑定

在一个函数体中使用this,当该函数被独立调用。可以把这条规则看作是无法应用其他规则时的默认规则。

```js
var name='111'
function Star(){
    console.log(this.name)
}
Star() //undefined   因为在编辑器里面没有window，在浏览器中调用的话就是111
```



#### 隐式绑定

隐式绑定的规则需要考虑的是调用位置是否有上下文对象，或者说是否被某个对象拥有或者包含。当然，这种说法并不准确。

```js
//定义一个全局变量
var v=100
//定义一个函数
function fn(){
    console.log(this.v)
}
//定义一个对象
var obj={
    v:200,
    f:fn//对象的f()方法指向fn()函数
}
// 定义一个全局变量，并被赋值为对象obj的f()方法
var fun=obj.f
// 将fun作为一个函数进行调用
fun()//undefined   因为在编辑器里面没有window，在浏览器中调用的话就是100
```



#### 显式绑定

显式绑定就是明确在调用时，this所绑定的对象。JavaScript中提 供了apply(方法和call)方法实现，这两个方法的第一个 参数接收是一个对象 ，会把这个对象绑定到this,接着在调用函数时指定这个this。

```js
//定义一个全局变量
var v=100
//定义一个函数
function fn(){
    console.log(this.v)
}
//定义一个对象
var obj={
    v:200,
    f:fn//对象的f()方法指向fn()函数
}
// 定义一个全局变量，并被赋值为对象obj的f()方法
var fun=obj.f
// 将fun作为一个函数进行调用
fun.apply(obj)//200
```


